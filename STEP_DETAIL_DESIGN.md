# ç ”ç©¶æ­¥éª¤è¯¦æƒ…å±•ç¤ºè®¾è®¡

## ä¸€ã€äº¤äº’è®¾è®¡

### 1.1 é¡µé¢å¸ƒå±€
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            èŠå¤©é¡µé¢                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚         ä¸»å†…å®¹åŒº (60%)               â”‚       è¯¦æƒ…é¢æ¿ (40%)             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ ç”¨æˆ·é—®é¢˜                       â”‚  â”‚  â”‚ ğŸ“Œ Step 5: å¹¶è¡Œæœç´¢       â”‚  â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚
â”‚  â”‚ ReAct æ™ºèƒ½æ¨ç†è¿‡ç¨‹             â”‚  â”‚  â”‚ æœç´¢å…³é”®è¯: ä¸­å›½AIå¸‚åœºè§„æ¨¡  â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚  â”‚                           â”‚  â”‚
â”‚  â”‚ â”‚ Step 1: ç ”ç©¶è®¡åˆ’        â”‚   â”‚  â”‚  â”‚ ğŸ“„ æœç´¢ç»“æœ (8æ¡)         â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚  â”‚ â”‚ 1. ä¸­å›½AIäº§ä¸šæŠ¥å‘Š    â”‚   â”‚  â”‚
â”‚  â”‚ â”‚ Step 2: æ€è€ƒ            â”‚   â”‚  â”‚  â”‚ â”‚    æ¥æº: è‰¾ç‘å’¨è¯¢    â”‚   â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚  â”‚ â”‚    æ‘˜è¦: 2024å¹´...   â”‚   â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚ â”‚ Step 3: å¤§çº² â† é€‰ä¸­     â”‚â—„â”€â”€â”¼â”€â”€â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚  â”‚ â”‚ 2. IDCæŠ¥å‘Š          â”‚   â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚  â”‚ â”‚    æ¥æº: IDC        â”‚   â”‚  â”‚
â”‚  â”‚ â”‚ Step 4: æœç´¢            â”‚   â”‚  â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚  â”‚                           â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚  â”‚ ğŸ“Š æå–çš„æ•°æ®ç‚¹ (3ä¸ª)     â”‚  â”‚
â”‚  â”‚ â”‚ Step 5: è§‚å¯Ÿ â† é€‰ä¸­     â”‚â—„â”€â”€â”¼â”€â”€â”‚  â”‚ â€¢ å¸‚åœºè§„æ¨¡: 1850äº¿        â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚  â”‚ â€¢ å¢é•¿ç‡: 24.4%          â”‚  â”‚
â”‚  â”‚                               â”‚  â”‚  â”‚ â€¢ ä¼ä¸šæ•°é‡: 4000+        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.2 äº¤äº’æµç¨‹
1. **é»˜è®¤çŠ¶æ€**: å³ä¾§é¢æ¿æ˜¾ç¤ºå½“å‰è¿›è¡Œä¸­æ­¥éª¤çš„è¯¦æƒ…
2. **ç‚¹å‡»æ­¥éª¤**: å³ä¾§é¢æ¿åˆ‡æ¢åˆ°è¯¥æ­¥éª¤çš„è¯¦æƒ…
3. **è‡ªåŠ¨æ»šåŠ¨**: æ–°æ­¥éª¤äº§ç”Ÿæ—¶ï¼Œè‡ªåŠ¨æ»šåŠ¨åˆ°æœ€æ–°æ­¥éª¤
4. **æ”¶èµ·/å±•å¼€**: å¯ä»¥æ”¶èµ·å³ä¾§é¢æ¿ï¼Œåªçœ‹æ­¥éª¤åˆ—è¡¨

---

## äºŒã€åç«¯äº‹ä»¶å¢å¼º

### 2.1 å½“å‰äº‹ä»¶æ ¼å¼
```python
# action äº‹ä»¶
{
    "type": "action",
    "agent": "DeepScout",
    "tool": "parallel_search",
    "section": "å¸‚åœºæ¦‚å†µ",
    "queries": ["ä¸­å›½AIå¸‚åœºè§„æ¨¡", "AIå¢é•¿ç‡"]
}

# observation äº‹ä»¶
{
    "type": "observation",
    "agent": "DeepScout",
    "section": "å¸‚åœºæ¦‚å†µ",
    "facts_count": 5,
    "data_points_count": 3
}
```

### 2.2 å¢å¼ºåçš„äº‹ä»¶æ ¼å¼
```python
# action äº‹ä»¶ (å¢å¼º)
{
    "type": "action",
    "step_id": "step_001",  # æ–°å¢: æ­¥éª¤IDç”¨äºå…³è”
    "agent": "DeepScout",
    "tool": "parallel_search",
    "section": "å¸‚åœºæ¦‚å†µ",
    "queries": ["ä¸­å›½AIå¸‚åœºè§„æ¨¡", "AIå¢é•¿ç‡"],
    "timestamp": 1703...
}

# observation äº‹ä»¶ (å¢å¼º) - åŒ…å«åŸå§‹æœç´¢ç»“æœ
{
    "type": "observation",
    "step_id": "step_001",  # å…³è”çš„actionæ­¥éª¤
    "agent": "DeepScout",
    "section": "å¸‚åœºæ¦‚å†µ",
    "facts_count": 5,
    "data_points_count": 3,

    # æ–°å¢: è¯¦ç»†çš„æœç´¢ç»“æœ
    "search_results": [
        {
            "title": "2024ä¸­å›½AIäº§ä¸šç ”ç©¶æŠ¥å‘Š",
            "url": "https://...",
            "source": "è‰¾ç‘å’¨è¯¢",
            "snippet": "æŠ¥å‘Šæ˜¾ç¤ºï¼Œ2024å¹´ä¸­å›½AIå¸‚åœºè§„æ¨¡...",
            "publish_date": "2024-03-15"
        }
    ],

    # æ–°å¢: æå–çš„æ•°æ®ç‚¹è¯¦æƒ…
    "data_points": [
        {"name": "å¸‚åœºè§„æ¨¡", "value": "1850", "unit": "äº¿å…ƒ", "year": 2024}
    ],

    # æ–°å¢: æå–çš„äº‹å®
    "facts": [
        {"content": "ä¸­å›½AIå¸‚åœºè§„æ¨¡è¾¾1850äº¿", "source": "è‰¾ç‘å’¨è¯¢", "credibility": 0.9}
    ]
}

# outline äº‹ä»¶ (å·²æœ‰ï¼Œä¿æŒ)
{
    "type": "outline",
    "outline": [...],
    "research_questions": [...]
}

# chart äº‹ä»¶ (å¢å¼º)
{
    "type": "chart",
    "step_id": "step_005",
    "chart_type": "line",
    "title": "ä¸­å›½AIå¸‚åœºè§„æ¨¡è¶‹åŠ¿",
    "echarts_option": {...}  # ECharts é…ç½®
}
```

---

## ä¸‰ã€å‰ç«¯å®ç°

### 3.1 æ•°æ®ç»“æ„
```typescript
// æ­¥éª¤è¯¦æƒ…ç±»å‹
interface StepDetail {
  stepId: string;
  type: 'plan' | 'thought' | 'action' | 'observation';
  content: string;
  timestamp: number;

  // å¯é€‰çš„è¯¦ç»†æ•°æ®
  searchResults?: SearchResult[];
  dataPoints?: DataPoint[];
  facts?: Fact[];
  outline?: OutlineSection[];
  chart?: ChartConfig;
}

interface SearchResult {
  title: string;
  url: string;
  source: string;
  snippet: string;
  publishDate?: string;
}

interface DataPoint {
  name: string;
  value: string;
  unit: string;
  year?: number;
}
```

### 3.2 ç»„ä»¶ç»“æ„
```
src/pages/chat/
â”œâ”€â”€ index.tsx                    # ä¸»é¡µé¢
â”œâ”€â”€ component/
â”‚   â”œâ”€â”€ result.tsx               # ç»“æœå±•ç¤º (å·²æœ‰)
â”‚   â”œâ”€â”€ step-detail-panel/       # æ–°å¢: æ­¥éª¤è¯¦æƒ…é¢æ¿
â”‚   â”‚   â”œâ”€â”€ index.tsx            # é¢æ¿å®¹å™¨
â”‚   â”‚   â”œâ”€â”€ SearchResults.tsx    # æœç´¢ç»“æœåˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ DataPointsTable.tsx  # æ•°æ®ç‚¹è¡¨æ ¼
â”‚   â”‚   â”œâ”€â”€ FactsList.tsx        # äº‹å®åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ OutlineView.tsx      # å¤§çº²è§†å›¾
â”‚   â”‚   â””â”€â”€ ChartView.tsx        # å›¾è¡¨è§†å›¾
â”‚   â””â”€â”€ ...
```

### 3.3 çŠ¶æ€ç®¡ç†
```typescript
// åœ¨ index.tsx ä¸­æ·»åŠ çŠ¶æ€
const [selectedStepId, setSelectedStepId] = useState<string | null>(null);
const [stepDetails, setStepDetails] = useState<Map<string, StepDetail>>(new Map());

// è§£æäº‹ä»¶æ—¶ä¿å­˜è¯¦æƒ…
if (json.type === 'observation') {
  const stepId = json.step_id || `step_${Date.now()}`;
  setStepDetails(prev => {
    const newMap = new Map(prev);
    newMap.set(stepId, {
      stepId,
      type: 'observation',
      content: '...',
      searchResults: json.search_results,
      dataPoints: json.data_points,
      facts: json.facts,
      timestamp: Date.now()
    });
    return newMap;
  });
}
```

---

## å››ã€å®ç°æ­¥éª¤

### Phase 1: åç«¯å¢å¼º (scout.py)
1. åœ¨ observation äº‹ä»¶ä¸­æ·»åŠ  `search_results` åŸå§‹æ•°æ®
2. æ·»åŠ  `step_id` ç”¨äºå…³è”
3. æ·»åŠ  `data_points` å’Œ `facts` è¯¦æƒ…

### Phase 2: å‰ç«¯ç»„ä»¶
1. åˆ›å»º `StepDetailPanel` ç»„ä»¶
2. å®ç° `SearchResults` æœç´¢ç»“æœåˆ—è¡¨
3. å®ç° `DataPointsTable` æ•°æ®è¡¨æ ¼
4. ç‚¹å‡»æ­¥éª¤æ—¶æ˜¾ç¤ºè¯¦æƒ…

### Phase 3: å›¾è¡¨æ”¯æŒ
1. å®‰è£… ECharts: `npm install echarts echarts-for-react`
2. åˆ›å»º `ChartView` ç»„ä»¶
3. å¤„ç† `chart` äº‹ä»¶å¹¶æ¸²æŸ“

---

## äº”ã€æ–‡ä»¶ä¿®æ”¹æ¸…å•

| æ–‡ä»¶ | æ“ä½œ | è¯´æ˜ |
|------|------|------|
| `backend/app/service/deep_research_v2/agents/scout.py` | ä¿®æ”¹ | åœ¨ observation ä¸­æ·»åŠ è¯¦ç»†æ•°æ® |
| `frontend/src/pages/chat/index.tsx` | ä¿®æ”¹ | æ·»åŠ æ­¥éª¤é€‰æ‹©çŠ¶æ€å’Œè¯¦æƒ…å­˜å‚¨ |
| `frontend/src/pages/chat/component/result.tsx` | ä¿®æ”¹ | æ­¥éª¤å¯ç‚¹å‡»ï¼Œæ·»åŠ é€‰ä¸­æ ·å¼ |
| `frontend/src/pages/chat/component/step-detail-panel/` | æ–°å»º | æ­¥éª¤è¯¦æƒ…é¢æ¿ç»„ä»¶ |
| `frontend/src/api/session.type.d.ts` | ä¿®æ”¹ | æ·»åŠ æ–°çš„ç±»å‹å®šä¹‰ |
